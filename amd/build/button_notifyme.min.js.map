{"version":3,"sources":["../src/button_notifyme.js"],"names":["init","buttons","document","querySelectorAll","forEach","button","dataset","initialized","userid","optionid","addEventListener","toggleNotifiy","console","log","Ajax","call","methodname","args","done","res","toggleButton","status","fail","err","statusstring","then","textContent","catch","e"],"mappings":"qLAqBA,uD,OASoB,QAAPA,CAAAA,IAAO,EAAM,CAEtB,GAAMC,CAAAA,CAAO,CAAGC,QAAQ,CAACC,gBAAT,CAA0B,2BAA1B,CAAhB,CAEA,GAAIF,CAAJ,CAAa,CACTA,CAAO,CAACG,OAAR,CAAgB,SAAAC,CAAM,CAAI,CAEtB,GAAIA,CAAM,CAACC,OAAP,CAAeC,WAAnB,CAAgC,CAC5B,MACH,CAJqB,GAKhBC,CAAAA,CAAM,CAAGH,CAAM,CAACC,OAAP,CAAeE,MALR,CAMhBC,CAAQ,CAAGJ,CAAM,CAACC,OAAP,CAAeG,QANV,CAQtBJ,CAAM,CAACK,gBAAP,CAAwB,OAAxB,CAAiC,UAAM,CACnCC,CAAa,CAACN,CAAD,CAASG,CAAT,CAAiBC,CAAjB,CAChB,CAFD,EAGAJ,CAAM,CAACC,OAAP,CAAeC,WAAf,GACH,CAZD,CAaH,CACJ,C,CAQO,GAAMI,CAAAA,CAAa,CAAG,SAC1BN,CAD0B,CAE1BG,CAF0B,CAG1BC,CAH0B,CAGb,CAGbG,OAAO,CAACC,GAAR,CAAY,iBAAZ,CAA+BL,CAA/B,CAAuCC,CAAvC,EAEAK,UAAKC,IAAL,CAAU,CAAC,CACPC,UAAU,CAAE,gCADL,CAEPC,IAAI,CAAE,CACF,OAAUT,CADR,CAEF,SAAYC,CAFV,CAFC,CAMPS,IAAI,CAAE,cAASC,CAAT,CAAc,CAGhBP,OAAO,CAACC,GAAR,CAAYM,CAAZ,EAEAC,CAAY,CAACf,CAAD,CAASc,CAAG,CAACE,MAAb,CAAZ,CAEA,QACH,CAdM,CAePC,IAAI,CAAE,cAASC,CAAT,CAAc,CAGhBX,OAAO,CAACC,GAAR,CAAY,sBAAZ,CAAoCU,CAApC,CACH,CAnBM,CAAD,CAAV,CAqBH,CA7BO,C,kBAoCR,QAASH,CAAAA,CAAT,CAAsBf,CAAtB,CAA8BgB,CAA9B,CAAsC,CAClC,GAAMG,CAAAA,CAAY,CAAa,CAAV,EAAAH,CAAM,CAAQ,eAAR,CAA0B,UAArD,CAEA,iBAAUG,CAAV,CAAwB,aAAxB,EAAuCC,IAAvC,CAA4C,SAAAN,CAAG,CAAI,CAC/Cd,CAAM,CAACqB,WAAP,CAAqBP,CAExB,CAHD,EAGGQ,KAHH,CAGS,SAAAC,CAAC,CAAI,CAEVhB,OAAO,CAACC,GAAR,CAAYe,CAAZ,CACH,CAND,CAOH,C","sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/*\n * @package    mod_booking\n * @copyright  Wunderbyte GmbH <info@wunderbyte.at>\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\nimport Ajax from 'core/ajax';\nimport {get_string as getString} from 'core/str';\n// import Notification from 'core/notification';\n\n/**\n * Gets called from mustache template.\n * @param {int} optionid\n * @param {int} userid\n */\nexport const init = () => {\n\n    const buttons = document.querySelectorAll(\".booking-button-notify-me\");\n\n    if (buttons) {\n        buttons.forEach(button => {\n\n            if (button.dataset.initialized) {\n                return;\n            }\n            const userid = button.dataset.userid;\n            const optionid = button.dataset.optionid;\n\n            button.addEventListener('click', () => {\n                toggleNotifiy(button, userid, optionid);\n            });\n            button.dataset.initialized = true;\n        });\n    }\n};\n\n/**\n * Toggle Notify\n * @param {any} button\n * @param {int} userid\n * @param {int} optionid\n */\n export const toggleNotifiy = (\n    button,\n    userid,\n    optionid) => {\n\n    // eslint-disable-next-line no-console\n    console.log('we trigger call', userid, optionid);\n\n    Ajax.call([{\n        methodname: \"mod_booking_toggle_notify_user\",\n        args: {\n            'userid': userid,\n            'optionid': optionid\n        },\n        done: function(res) {\n\n            // eslint-disable-next-line no-console\n            console.log(res);\n\n            toggleButton(button, res.status);\n\n            return true;\n        },\n        fail: function(err) {\n\n            // eslint-disable-next-line no-console\n            console.log('something went wrong', err);\n        }\n    }]);\n};\n\n/**\n *\n * @param {*} button\n * @param {*} status\n */\nfunction toggleButton(button, status) {\n    const statusstring = status == 1 ? 'alreadyonlist' : 'notifyme';\n\n    getString(statusstring, 'mod_booking').then(res => {\n        button.textContent = res;\n        return;\n    }).catch(e => {\n        // eslint-disable-next-line no-console\n        console.log(e);\n    });\n}"],"file":"button_notifyme.min.js"}