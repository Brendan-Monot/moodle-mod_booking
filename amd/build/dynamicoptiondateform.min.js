define ("mod_booking/dynamicoptiondateform",["exports","core_form/dynamicform","core_form/modalform","core/templates"],function(a,b,c,d){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.initmodaloptiondateform=a.datelistinit=a.initdynamicoptiondateform=void 0;b=e(b);c=e(c);d=e(d);function e(a){return a&&a.__esModule?a:{default:a}}var g=new b.default(document.querySelector("#optiondates-form"),"mod_booking\\form\\dynamicoptiondateform");a.initdynamicoptiondateform=function initdynamicoptiondateform(a,b,c,f,j){g.load({cmid:a,bookingid:b,optionid:c,modalTitle:f,formClass:j}).then(function(){h();i(f,j)}).catch(function(a){return displayException(a)});g.addEventListener(g.events.FORM_SUBMITTED,function(k){var e=document.querySelector("[name=\"chooseperiod\"]").value,l=document.querySelector("[name=\"reoccurringdatestring\"]").value;g.load({cmid:a,bookingid:b,optionid:c,modalTitle:f,formClass:j}).then(function(){k.preventDefault();var a=k.detail;d.default.renderForPromise("mod_booking/bookingoption_dates",a).then(function(a){var b=a.html;document.querySelector(".optiondates-list").innerHTML="";d.default.appendNodeContents(".optiondates-list",b)}).catch(function(a){return displayException(a)});var b=document.getElementsByClassName("optiondates-list");while(1<b.length){b[b.length-1].parentNode.removeChild(b[b.length-1])}h();document.querySelector("[name=\"chooseperiod\"]").value=e;document.querySelector("[name=\"reoccurringdatestring\"]").value=l;document.querySelector("#semesterid").value=e;document.querySelector("#dayofweektime").value=l;i(f,j)}).catch(function(a){return displayException(a)})})};var h=function(){var a=document.querySelector("#optiondates-form"),b=document.querySelector(".optiondates-list");b.parentNode.removeChild(b);a.parentNode.insertBefore(b,a.nextSibling);b.addEventListener("click",function(a){var b=a.target.dataset.action,c=a.target.dataset.targetid;if("delete"===b){a.target.closest("li").remove();document.getElementById(c).remove()}if("add"===b){var d=a.target.closest("li"),e=document.querySelector("#meeting-time"),f="<li><span class=\"badge bg-primary\">"+e.value+"</span> <i class=\"fa fa-trash ml-2 icon-red\" data-action=\"delete\"></i></li>";d.insertAdjacentHTML("afterend",f)}});document.querySelector("[name=\"chooseperiod\"]").addEventListener("change",function(a){document.querySelector("#semesterid").value=a.target.value});f("input[name=\"reoccurringdatestring\"]").then(function(a){var b=document.querySelector("#optiondates-form input[name=\"submitbutton\"]");if(a.value.trim().toLowerCase().includes("block")){b.style.display="none"}else{b.style.display="block"}});var c=document.querySelector("input[name=\"reoccurringdatestring\"]");c.addEventListener("keyup",function(a){var b=document.querySelector("#optiondates-form input[name=\"submitbutton\"]");if(a.target.value.trim().toLowerCase().includes("block")){b.style.display="none"}else{b.style.display="block"}document.querySelector("#dayofweektime").value=a.target.value})};a.datelistinit=h;var i=function(a,b){f("button[name=\"customdatesbtn\"]").then(function(e){e.addEventListener("click",function(f){f.preventDefault();var e=new c.default({formClass:b,modalConfig:{title:a},returnFocus:f.currentTarget});e.addEventListener(e.events.FORM_SUBMITTED,function(a){var b=a.detail;d.default.renderForPromise("mod_booking/bookingoption_dates_custom_list_items",b).then(function(a){var b=a.html;d.default.appendNodeContents("ul.reoccurringdates",b)}).catch(function(a){return displayException(a)});d.default.renderForPromise("mod_booking/bookingoption_dates_custom_hidden_inputs",b).then(function(a){var b=a.html;d.default.appendNodeContents("div.optiondates-list",b)}).catch(function(a){return displayException(a)})});e.show()})})};a.initmodaloptiondateform=i;function f(a){return new Promise(function(b){if(document.querySelector(a)){return b(document.querySelector(a))}var c=new MutationObserver(function(){if(document.querySelector(a)){b(document.querySelector(a));c.disconnect()}});c.observe(document.body,{childList:!0,subtree:!0})})}});
//# sourceMappingURL=dynamicoptiondateform.min.js.map
